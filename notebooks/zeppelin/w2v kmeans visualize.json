{"paragraphs":[{"text":"%dep\nz.load(\"com.databricks:spark-csv_2.10:1.3.0\")","dateUpdated":"Feb 27, 2016 11:34:18 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456331128825_-1580663043","id":"20160224-192528_796382638","result":{"code":"SUCCESS","type":"TEXT","msg":"res0: org.apache.zeppelin.spark.dep.Dependency = org.apache.zeppelin.spark.dep.Dependency@72b4d8fc\n"},"dateCreated":"Feb 24, 2016 7:25:28 PM","dateStarted":"Feb 27, 2016 11:34:18 PM","dateFinished":"Feb 27, 2016 11:34:26 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20"},{"text":"import org.apache.spark._\nimport org.apache.spark.rdd._\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.mllib.feature.{Word2Vec, Word2VecModel}\nimport org.apache.spark.ml.clustering.KMeans\n\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.storage.StorageLevel\n\n//hdfs://172.26.5.36//analytics/pdml-html-tokenized-nonjs-noncss-eng/*\n//file:///home/ipertushin/Documents/data/pdml-html-tokenized-nonjs-noncss-eng/*\n///analytics/spacy/tokenized-docs\nval input = sc.textFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/spacy-eng-tokenized-nouns/*\", 100)\n        .map {  doc => \n                val terms = doc.split(\" \").toSeq\n                .filter{t => \n                    \"\"\"^([A-Za-z]{4,25})$\"\"\".r.findFirstMatchIn(t) match {\n                        case Some(s) => true\n                        case None => false\n                    }\n                } \n                terms\n            \n        }\n        .persist(StorageLevel.DISK_ONLY) //MEMORY_AND_DISK_SER \n   \n//save  \ninput.flatMap(identity)\n    .map(term => (term,1))\n    .reduceByKey((c1,c2) => c1+c2)\n    .saveAsTextFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/tf-engnouns4_20-map\")\n         \nval word2vec = new Word2Vec()\n                .setVectorSize(500)\n                .setWindowSize(10)\n                .setMinCount(5)\n                .setNumIterations(100)\n\nval model = word2vec.fit(input)\n\nmodel.save(sc, \"file:///home/ipertushin/Documents/data/analytics/spacy/w2v-model-engnouns-500f10w5mc100i\")\n\nval synonyms = model.findSynonyms(\"blowjob\", 10)\n\nprintln(synonyms)","dateUpdated":"Feb 23, 2016 1:10:30 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455311090881_-774682498","id":"20160213-000450_796535661","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark._\nimport org.apache.spark.rdd._\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.mllib.feature.{Word2Vec, Word2VecModel}\nimport org.apache.spark.ml.clustering.KMeans\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.storage.StorageLevel\ninput: org.apache.spark.rdd.RDD[Seq[String]] = MapPartitionsRDD[2] at map at <console>:48\nword2vec: org.apache.spark.mllib.feature.Word2Vec = org.apache.spark.mllib.feature.Word2Vec@267ead7b\nmodel: org.apache.spark.mllib.feature.Word2VecModel = org.apache.spark.mllib.feature.Word2VecModel@3412f767\nsynonyms: Array[(String, Double)] = Array((cumshot,2.672111634912036), (brunette,2.6684351502395005), (boob,2.458684940519437), (fuck,2.375015814826936), (babe,2.374094069948348), (pussy,2.3586734136348046), (milf,2.344495528630218), (handjob,2.2577902591377486), (creampie,2.246793051759104), (fisting,2.2273186595745824))\n[Lscala.Tuple2;@35806e50\n"},"dateCreated":"Feb 13, 2016 12:04:50 AM","dateStarted":"Feb 23, 2016 1:10:30 AM","dateFinished":"Feb 23, 2016 9:39:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21"},{"text":"import org.apache.spark._\nimport org.apache.spark.rdd._\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.mllib.feature.{Word2Vec, Word2VecModel}\nimport org.apache.spark.ml.clustering.KMeans\n\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.storage.StorageLevel\n\n//hdfs://172.26.5.36//analytics/pdml-html-tokenized-nonjs-noncss-eng/*\n//file:///home/ipertushin/Documents/data/pdml-html-tokenized-nonjs-noncss-eng/*\n///analytics/spacy/tokenized-docs\n//file:///home/ipertushin/Documents/data/analytics/spacy/tokenized-docs\nval dc = sc.textFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/tokenized-docs/*\", 100)\n        .map {  doc =>  \n                val terms = doc.split(\" \").toSeq.filter{t => \n                    \"\"\"^([A-Za-z]{3,20})$\"\"\".r.findFirstMatchIn(t) match {\n                        case Some(s) => true\n                        case None => false\n                    }\n                } \n                terms\n        }\n        .flatMap(identity)\n        .distinct()\n        .count()\n        \nprintln(dc)\n\nArray((blonde,2.8994588032013087), (fuck,2.800761575023895), (brunette,2.781371346066663), (asian,2.765074661164226), (tit,2.7621500677093556), (cock,2.7595713239237285), (hardcore,2.7592514655448865), (suck,2.7541306080238463), (amateur,2.7168813593265106), (chick,2.700442876151707))\n\n Array((brunette,2.5618052110859586), (cumshot,2.530879546615626), (pussy,2.239426476635934), (fuck,2.2376370376471444), (boob,2.218017944180948), (blonde,2.2094367280349863), (tit,2.1911271135217616), (pov,2.1738048162880497), (creampie,2.144412549997618), (dildo,2.135443872839995))","dateUpdated":"Feb 18, 2016 12:38:23 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455697458049_-775942240","id":"20160217-112418_1945833003","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark._\nimport org.apache.spark.rdd._\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.mllib.feature.{Word2Vec, Word2VecModel}\nimport org.apache.spark.ml.clustering.KMeans\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.storage.StorageLevel\ndc: Long = 54851\n54851\n"},"dateCreated":"Feb 17, 2016 11:24:18 AM","dateStarted":"Feb 17, 2016 12:06:21 PM","dateFinished":"Feb 17, 2016 12:06:34 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22"},{"text":"\nimport org.apache.spark.mllib.feature.{Word2Vec, Word2VecModel}\n\n//hdfs://172.26.5.36//analytics/pdml-html-tokenized-nonjs-noncss-eng/*\n//file:///home/ipertushin/Documents/data/analytics/w2v-model-eng-500f\nval modelW2V = Word2VecModel.load(sc, \"file:///home/ipertushin/Documents/data/analytics/spacy/w2v-model-engnouns-500f10w5mc100i\")\n\nval vecs = modelW2V.getVectors\n\nval pVecs = sc.parallelize(vecs.toSeq)\n                .map{case(word,vector) => \n                    (word, vector.mkString(\" \"))\n                }\n                \npVecs.saveAsTextFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/w2v-map-engnouns-500f10w5mc100i\")\n","dateUpdated":"Feb 23, 2016 9:52:13 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455448854118_-1544512701","id":"20160214-142054_774666185","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.mllib.feature.{Word2Vec, Word2VecModel}\nmodelW2V: org.apache.spark.mllib.feature.Word2VecModel = org.apache.spark.mllib.feature.Word2VecModel@5692268e\nvecs: Map[String,Array[Float]] = Map(besucht -> Array(0.07702084, -0.16821614, -0.11762914, 0.29653984, 0.35326594, 0.3033889, 0.22723582, 0.2628868, 0.8674098, 0.048221298, 0.2351893, 0.3571364, 0.37074974, -0.16675396, -0.19522564, 0.6261281, -0.34812915, 0.11092383, -0.21320532, -0.9318396, 0.09031475, 0.0062417653, -0.0742132, 0.38764283, 0.21250437, -0.55815023, 0.08603577, -0.29337358, -0.09017291, 1.1869472, 0.49254867, -0.02497732, -0.60931355, 0.43714258, 0.13857922, 0.1400379, -0.35794455, -0.14299017, 0.027497549, -0.055425342, 0.1471686, 0.4616255, -0.9590568, -0.06297084, 0.6822774, -0.6517246, -0.13180141, -0.44599858, -0.238637, 0.13865769, 0.48641503, 0.44125518, -0.0109893065, 0.11136675, -0.52161175, -0.042803667, 0.2123024, 0.048194177, 0.37265933, -0.19685386, -0.292...pVecs: org.apache.spark.rdd.RDD[(String, String)] = MapPartitionsRDD[229] at map at <console>:51\n"},"dateCreated":"Feb 14, 2016 2:20:54 PM","dateStarted":"Feb 23, 2016 9:52:13 PM","dateFinished":"Feb 23, 2016 9:52:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23"},{"text":"import org.apache.spark.mllib.feature.{Word2Vec, Word2VecModel}\n\n//hdfs://172.26.5.36//analytics/pdml-html-tokenized-nonjs-noncss-eng/*\n//file:///home/ipertushin/Documents/data/analytics/w2v-model-eng-500f\nval modelW2V = Word2VecModel.load(sc, \"file:///home/ipertushin/Documents/data/analytics/spacy/w2v-model-engnouns-500f10w5mc100i\")\n\nval synonyms = modelW2V.findSynonyms(\"squirt\", 100)\n                .map{case(w,cs) => w}\n\nprintln(synonyms)","dateUpdated":"Feb 24, 2016 6:48:08 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455797612716_-348550110","id":"20160218-151332_512946047","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.mllib.feature.{Word2Vec, Word2VecModel}\nmodelW2V: org.apache.spark.mllib.feature.Word2VecModel = org.apache.spark.mllib.feature.Word2VecModel@43134311\nsynonyms: Array[String] = Array(cock, moana, gabrielle, troia, fuck, lesbian, reassurance, chick, busty, babe, brunette, throat, caning, cumslut, tonsil, european, hitomi, masseuse, gangbang, masturbates, slut, suck, undress, milf, milfs, tease, teasing, pimp, handjobs, brit, hardcore, granny, bigass, blonde, boob, youn, whore, ebony, adriana, cougar, assfuck, blond, titjob, newyork, stallion, amateur, redhead, susanna, madame, pussy, lingerie, anal, blowjob, lactating, karin, couple, daughter, starring, creampie, maggie, horny, chubby, saleman, loni, dildo, grannie, twat, mistress, doggystyle, jock, webcam, maniac, bombshell, libertine, hairy, orgy, julia, orgasm, tranny, harte, puta, mother, boobed, seduces, coed, fucking, cunt, stepdad, fucker, amanda, braid, dude, frontal, katarina,...[Ljava.lang.String;@5144d9e4\n"},"dateCreated":"Feb 18, 2016 3:13:32 PM","dateStarted":"Feb 24, 2016 6:48:08 PM","dateFinished":"Feb 24, 2016 6:48:12 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:24"},{"text":"import org.apache.spark.mllib.clustering.{KMeans, KMeansModel}\nimport org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.storage.StorageLevel\n\n// Load and parse the data\n//hdfs://172.26.5.36//analytics/w2v-kmeans-visialization/\n//file:///home/ipertushin/Documents/data/analytics/\nval skipWord = \"skip-word\"\nval w2vMap = sc.textFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/w2v-map-engnouns-500f\",100)\n                    .map{s => \n                                \"\"\"\\(([A-Za-z]{3,20}),(.*)\\)\"\"\".r.findFirstMatchIn(s) match{\n                                    case Some(m) => (m.group(1), Vectors.dense(m.group(2).split(' ').map(_.toDouble)))\n                                    case None => (skipWord,Vectors.zeros(1))\n                                }\n                }\n                .filter{case(w,v) => !w.equals(skipWord)}\n                .cache()\n\nval numClusters = 3000\nval numIterations = 1000\n\nval vectors = w2vMap.map{case(w,v) => v}\nval clusters = KMeans.train(vectors, numClusters, numIterations)\n\n// Evaluate clustering by computing Within Set Sum of Squared Errors\nval WSSSE = clusters.computeCost(vectors)\nprintln(\"Within Set Sum of Squared Errors = \" + WSSSE)\n\n// Save and load model\nclusters.save(sc, \"file:///home/ipertushin/Documents/data/analytics/spacy/kmeans-model-engnouns-300k1000i\")","dateUpdated":"Feb 22, 2016 7:21:15 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455469203779_-600828449","id":"20160214-200003_466737426","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.mllib.clustering.{KMeans, KMeansModel}\nimport org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.storage.StorageLevel\nskipWord: String = skip-word\nw2vMap: org.apache.spark.rdd.RDD[(String, org.apache.spark.mllib.linalg.Vector)] = MapPartitionsRDD[327] at filter at <console>:48\nnumClusters: Int = 300\nnumIterations: Int = 1000\nvectors: org.apache.spark.rdd.RDD[org.apache.spark.mllib.linalg.Vector] = MapPartitionsRDD[328] at map at <console>:44\nclusters: org.apache.spark.mllib.clustering.KMeansModel = org.apache.spark.mllib.clustering.KMeansModel@17f42167\nWSSSE: Double = 613184.1637964231\nWithin Set Sum of Squared Errors = 613184.1637964231\n"},"dateCreated":"Feb 14, 2016 8:00:03 PM","dateStarted":"Feb 18, 2016 6:10:01 PM","dateFinished":"Feb 18, 2016 6:14:06 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25"},{"text":"import org.apache.spark.mllib.clustering.{KMeans, KMeansModel}\nimport org.apache.spark.mllib.linalg.{Vector, Vectors}\n\n// Load and parse the data\n//(\"file:///home/ipertushin/Documents/data/analytics/spacy/w2v-map-engnouns-2f-tsne\"\n//file:///home/ipertushin/Documents/data/analytics/spacy/w2v-map-engnouns-500f\nval data = sc.textFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/w2v-map-engnouns-500f10w5mc100i-tsne2f\")\n\n/*.map{s => \n                                \"\"\"\\(([A-Za-z]{3,20}),(.*)\\)\"\"\".r.findFirstMatchIn(s) match{\n                                    case Some(m) => (m.group(1), Vectors.dense(m.group(2).split(' ').map(_.toDouble)))\n                                    case None => (\"\",Vectors.zeros(1))\n                                }\n                }*/\n                \nval wordToVecMap = data\n                .map{s => \"\"\"\\[u\\'([A-Za-z]{3,30})\\',(.*)\\]\"\"\".r.findFirstMatchIn(s) match{\n                                    case Some(m) => (m.group(1), Vectors.dense(m.group(2).split(\", \").map(_.toDouble)))\n                                    case None => (\"\",Vectors.zeros(1))\n                                }\n                }\n                .filter{case(w,v) => !w.equals(\"\")}\n                .cache()\n              \n\nwordToVecMap.take(5).foreach(println)         \n     \n     //file:///home/ipertushin/Documents/data/analytics/spacy/kmeans-model-engnouns-tsne-1000k1000i           \n     //file:///home/ipertushin/Documents/data/analytics/spacy/kmeans-model-engnouns-300k1000i\nval kmeansModel = KMeansModel.load(sc, \"file:///home/ipertushin/Documents/data/analytics/spacy/kmeans-model-engnouns-500f10w5mc100i-tsne2f15ee-1000k1000i\")\n                \n\nval predictions = wordToVecMap.map{case(w,v) => (w, v, kmeansModel.predict(v))}\n\npredictions.saveAsTextFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/kmeans-model-engnouns-1000k1000-predictionsTemp2\")\n\nval tfMap = sc.textFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/tf-engnouns4_20-map\")\n            .map{s => \n                    \"\"\"\\(([A-Za-z]{4,20}),(\\d{1,10})\\)\"\"\".r.findFirstMatchIn(s) match{\n                                case Some(m) => (m.group(1), m.group(2).toInt)\n                                case None => (\"\",0)\n                    }\n            }\n            .filter{case(t,f)=> f > 0}\n\nprintln(tfMap.count())\n\ncase class WordStat(word:String, clusterId: Int, f: Int)\nval wordStats = predictions\n                .map{case(w,v,c) => (w,c)}\n                .join(tfMap)\n                .map{ case (w,(c,f)) =>  WordStat(w,c, f)}\n\nwordStats.toDF().registerTempTable(\"WordStats\")\nwordStats.take(3).foreach(println)\n\ncase class ClusterDataRow(clusterId: Int, words: String)\nval clusterWords = predictions\n                        .map{case(w,v,c) => (c,w)}\n                        .aggregateByKey(Seq.empty[String])(\n                            (seq,word) => seq.:+(word),\n                            (seq1,seq2) => seq1++seq2 \n                        )\n                        .map{case(c, seq) => ClusterDataRow(c,seq.mkString(\", \"))}\n                        .toDF()\n                        \nclusterWords.toDF().registerTempTable(\"ClusterWords\")\nclusterWords.take(3).foreach(println)\n\ncase class ClusterMedianRow(clusterId: Int, median: Int)\n\nval clustersMedian= wordStats\n                    .map{case(ws) => (ws.clusterId, ws.f)}\n                    .aggregateByKey(Seq.empty[Int])(\n                            (seq,word) => seq.:+(word),\n                            (seq1,seq2) => seq1++seq2 \n                    )\n                    .map{case(c,s) => val ns = s.sorted.distinct\n                                      val  median =  ns.drop(ns.size/2).head\n                                      ClusterMedianRow(c,median)\n                    }\n                    \nclustersMedian.take(3).foreach(println)\n\nclustersMedian.toDF().registerTempTable(\"ClustersMedian\")\n\n//top.write.format(\"json\").save(\"file:///home/ipertushin/Documents/data/analytics/spacy/wordsFrequency_k1500\")","dateUpdated":"Feb 27, 2016 11:18:33 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455528640400_1002426206","id":"20160215-123040_1163589489","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.mllib.clustering.{KMeans, KMeansModel}\nimport org.apache.spark.mllib.linalg.{Vector, Vectors}\ndata: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[14] at textFile at <console>:38\nwordToVecMap: org.apache.spark.rdd.RDD[(String, org.apache.spark.mllib.linalg.Vector)] = MapPartitionsRDD[16] at filter at <console>:50\n(tipico,[0.5858243271302431,0.3761340258795576])\n(hawkins,[0.266584043056477,0.6119841222048215])\n(jeanne,[0.493485957734197,0.8020891126075611])\n(leah,[0.3928463468471909,0.6113712330911937])\n(cornerstone,[0.12665669433078086,0.5622439308360642])\nkmeansModel: org.apache.spark.mllib.clustering.KMeansModel = org.apache.spark.mllib.clustering.KMeansModel@3e5aeba7\npredictions: org.apache.spark.rdd.RDD[(String, org.apache.spark.mllib.linalg.Vector, Int)] = MapPartitionsRDD[24] at map at <console>:42\ntfMap: org.apache.spark.rdd.RDD[(String, Int)] = MapPartitionsRDD[29] at filter at <console>:42\n38698\ndefined class WordStat\nwordStats: org.apache.spark.rdd.RDD[WordStat] = MapPartitionsRDD[34] at map at <console>:49\nWordStat(jocelyn,797,10)\nWordStat(centerman,663,15)\nWordStat(stronie,74,9)\ndefined class ClusterDataRow\nclusterWords: org.apache.spark.sql.DataFrame = [clusterId: int, words: string]\n[384,chinois, masseur, ejaculation, tutor, tempo, schwarz]\n[692,bloomington, guantanamo, kidnapping, treasurer, biden, jeffrey, renegade, hitting, ryans, clarence, allegiance, regular, flynn, shortstop, fetus, cheltenham, jameis, mutombo, lloyd, chivas, sutton, wasting, inequity, homecoming, deceit, gadhafi, septum, resurrection, survivor, colton, dawson, meijer, grafton, pigskin, sophomore, carmen]\n[932,start, option, drain, paste]\ndefined class ClusterMedianRow\nclustersMedian: org.apache.spark.rdd.RDD[ClusterMedianRow] = MapPartitionsRDD[43] at map at <console>:57\nClusterMedianRow(404,706)\nClusterMedianRow(101,8)\nClusterMedianRow(707,7)\n"},"dateCreated":"Feb 15, 2016 12:30:40 PM","dateStarted":"Feb 27, 2016 11:18:33 PM","dateFinished":"Feb 27, 2016 11:18:59 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26"},{"text":"import org.apache.spark.sql.SaveMode\n\nval topWordsFrequency = sqlContext.sql(\"select  ws.clusterId, sum(ws.f) as wordsFrequency, cm.median, cd.words\" +\n                            \" from WordStats ws\" +\n                            \" join ClusterWords cd on ws.clusterId = cd.clusterId\" +\n                            \" join ClustersMedian cm on ws.clusterId = cm.clusterId\" +\n                            \" group by ws.clusterId,  cd.words , cm.median\"+\n                            \" order by  wordsFrequency DESC\"\n    )\n \n topWordsFrequency.repartition(1).write.\n    mode(SaveMode.Overwrite).\n    format(\"com.databricks.spark.csv\").\n    option(\"header\", \"false\").\n    save(\"file:///home/ipertushin/Documents/data/analytics/spacy/topWordsFrequency_k1000.csv\")\n    \nval topMedian = sqlContext.sql(\"select  ws.clusterId, sum(ws.f) as wordsFrequency, cm.median, cd.words\" +\n                            \" from WordStats ws\" +\n                            \" join ClusterWords cd on ws.clusterId = cd.clusterId\" +\n                            \" join ClustersMedian cm on ws.clusterId = cm.clusterId\" +\n                            \" group by ws.clusterId,  cd.words , cm.median\"+\n                            \" order by  cm.median DESC\"\n    )\n \n topMedian.repartition(1).write.\n    mode(SaveMode.Overwrite).\n    format(\"com.databricks.spark.csv\").\n    option(\"header\", \"false\").\n    save(\"file:///home/ipertushin/Documents/data/analytics/spacy/topMedian_k1000.csv\")\n    \n   ","dateUpdated":"Feb 27, 2016 11:14:45 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456310527159_2120097809","id":"20160224-134207_540901454","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.SaveMode\ntopWordsFrequency: org.apache.spark.sql.DataFrame = [clusterId: int, wordsFrequency: bigint, median: int, words: string]\ntopMedian: org.apache.spark.sql.DataFrame = [clusterId: int, wordsFrequency: bigint, median: int, words: string]\n"},"dateCreated":"Feb 24, 2016 1:42:07 PM","dateStarted":"Feb 24, 2016 7:28:34 PM","dateFinished":"Feb 24, 2016 7:29:19 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27"},{"text":"//-------------\nimport org.apache.spark.sql.SaveMode\n\nval someTest = sqlContext.sql(\"select  ws.clusterId, sum(ws.f) as wordsFrequency, cm.median, cd.words\" +\n                            \" from WordStats ws\" +\n                            \" join ClusterWords cd on ws.clusterId = cd.clusterId\" +\n                            \" join ClustersMedian cm on ws.clusterId = cm.clusterId\" +\n                            \" where cd.words like '%sex%'\" +\n                            \" group by ws.clusterId,  cd.words , cm.median\"+\n                            \" order by  cm.median DESC\"\n    )\n \n someTest.repartition(1).write.\n    mode(SaveMode.Overwrite).\n    format(\"com.databricks.spark.csv\").\n    option(\"header\", \"false\").\n    save(\"file:///home/ipertushin/Documents/data/analytics/spacy/someTest2_k1000.csv\")","dateUpdated":"Feb 27, 2016 11:30:46 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456604073974_320145239","id":"20160227-231433_434427612","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.SaveMode\nsomeTest: org.apache.spark.sql.DataFrame = [clusterId: int, wordsFrequency: bigint, median: int, words: string]\n"},"dateCreated":"Feb 27, 2016 11:14:33 PM","dateStarted":"Feb 27, 2016 11:30:46 PM","dateFinished":"Feb 27, 2016 11:30:59 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28"},{"text":"%pyspark\n#from pyspark.sql import SQLContext\n#sqlContext = SQLContext(sc)\n\n#df = sqlContext.read.json(\"file:///home/ipertushin/Documents/data/analytics/spacy/someTest_k1000.csv\")\n\n#df.registerTempTable(\"TopMedian\")\n#topMedianClusters = sqlContext.sql(\"select * from TopMedian limit 100\")\n#topMedianClusters.show()\n\nimport matplotlib\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.spatial import ConvexHull\n\n# .map (lambda m: (m['w'], np.array([float(x) for x in m['v'].split(' ')])))\n#(tipico,[0.5858243271302431,0.3761340258795576],9)\ndef parsePrediction(m):\n        tmp = m.split(\",\")\n        w = tmp[0][1:]\n        \n        x = tmp[1][1:]\n        y = tmp[2][:-1]\n        v = np.array([float(x),float(y)])\n        \n        c = tmp[3][:-1]\n        return {'w':w,'v':v, 'c': c}\n        \ntop = sc.textFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/someTest2_k1000.csv\"). \\\n        map(lambda r : r.split(\",\")[0])\n\ntop100 = top.take(10);\nprint(top100)\n\npredictions = sc.textFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/kmeans-model-engnouns-1000k1000-predictions\")\\\n                .map(lambda p: parsePrediction(p))\n                \ntopPredictions = predictions.filter(lambda p: p['c'] in top100)\n\n#topPredictions.saveAsTextFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/kmeans-model-engnouns-1000k1000-top100predictions\")\n\nimport colorsys\nN=1500\nHSV_tuples = [(x*1.0/N, 0.5, 0.5) for x in range(N)]\nRGB_tuples = list(map(lambda x: colorsys.hsv_to_rgb(*x), HSV_tuples))\n\nplt.figure(figsize=(150, 150))  #in inches\n\n#axes = plt.gca()\n#axes.set_xlim([-1,1])\n#axes.set_ylim([-1,1])\n\nfor p in topPredictions.collect():\n   # print(p)\n    c = p.items()[0]\n    clusterColor =  RGB_tuples[int(c[1])]\n    w = p.items()[1]\n    v = p.items()[2]\n    \n    plt.scatter( v[1][0],v[1][1],c=clusterColor, s=150, edgecolor='none')\n  \n    plt.annotate(w[1],\n                 xy=(v[1][0],  v[1][1]),\n                 xytext=(3, 5),\n                 textcoords='offset points',\n                 ha='left',\n                 va='bottom')\n\nplt.savefig(\"/home/ipertushin/Documents/data/analytics/spacy/someTest2_k1000.png\")\n\n  #plt.plot( v[1][0],  v[1][1], 'ro')","dateUpdated":"Feb 27, 2016 11:34:31 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456307496712_-1030780023","id":"20160224-125136_1956943772","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'576', u'417', u'79', u'879', u'203', u'999', u'550', u'365', u'990', u'797']\n"},"dateCreated":"Feb 24, 2016 12:51:36 PM","dateStarted":"Feb 27, 2016 11:34:31 PM","dateFinished":"Feb 27, 2016 11:34:59 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29"},{"text":"%sql\nselect  ws.clusterId, sum(ws.f) as clusterRating , cm.median ,cd.words\n    from WordStats ws \n    join ClusterWords cd on ws.clusterId = cd.clusterId\n    join ClustersMedian cm on ws.clusterId = cm.clusterId\n    \ngroup by ws.clusterId,  cd.words , cm.median\norder by  cm.median DESC\nlimit 100","dateUpdated":"Feb 24, 2016 7:58:05 PM","config":{"colWidth":12,"graph":{"mode":"table","height":498,"optionOpen":false,"keys":[{"name":"clusterId","index":0,"aggr":"sum"}],"values":[{"name":"clusterRating","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"clusterId","index":0,"aggr":"sum"},"yAxis":{"name":"clusterRating","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456164533544_-1355906843","id":"20160222-210853_1689669111","result":{"code":"SUCCESS","type":"TABLE","msg":"clusterId\tclusterRating\tmedian\twords\n319\t115048\t5812\tsorenson, affordability, increase, idea, situation, acre, finish, arne, calculator, trend, design, renter, project, process, bathroom, refinance, cost, kitchen, budget\n342\t20613\t4944\tbedding, appraisal, level, razorback, term, privacy\n634\t12978\t3088\tdiscussion, moxy, look, coverage, berjaya\n788\t33075\t2911\tdahlia, crabtree, improvement, remodel, accordion, visitor, rating, lanai\n685\t27903\t2903\tconvention, frenzy, finder, foreclosure, buyer, valuation, longview, boro\n97\t29491\t2711\tbanquet, baggage, attendance, zone, elementary, pantera, boundary, ranch, decision, comparison, disclaimer, grade, photocopying\n939\t7463\t2708\tstub, replay, timing\n36\t51886\t2701\tcapture, rise, tman, bedroom, attention, satellite, mortgage, springhill\n572\t9744\t2670\tdirectory, comcast, harbour, forecast, advice\n374\t52898\t2497\tcoldwell, banker, lender, notch, hostel, deck, connecticut, addition, approval, midpoint, guesthouse\n306\t2414\t2309\tgetaway, currency\n988\t2339\t2113\tstorage, iron\n932\t8698\t1902\tstart, option, drain, paste\n679\t6726\t1701\tkeyup, build, blur, invocation\n388\t1643\t1630\tleisure, nightlife\n244\t8359\t1504\trelic, boomerang, chan, cust, regexp, addr\n277\t3211\t1478\tpong, warehouse, crib, promotion\n164\t70342\t1478\tdetail, temperature, bistro, insurance, clarita, dairen\n448\t17654\t1275\tisland, terrace, apartment, lease, surcharge, hanoi, condo, median\n630\t163241\t1222\tparking, sanam, remax, sand, home, kota, overview\n893\t255630\t1216\tsudoku, rowland, zillow, sale, walkway, espanol, verizon, apply, canyon, puente, park, pullman\n806\t12892\t1190\timpression, retrieve, oops, webclient, mousemove, cloudflare, troubleshooting, keydown, oracle, verbose, petok, paragraph\n54\t5277\t1183\tmotoring, hostess, recommendation, studio, tracey, garage\n178\t1549\t1093\thandmade, gourmet\n756\t1301\t1067\tquesto, della\n119\t4208\t1045\thorsepower, prop, material, trunk, occupant, drive, generator\n212\t75256\t1013\tjohor, foot, school, estate, peel, circle, villa, category, bungalow\n881\t23916\t897\tstay, viewing, volcano, connoisseur, jersey, marriott, experiment, illustrator, thesis, grass, player, choice\n506\t85606\t894\theat, east, beach, viber, market, recipe, scenery, resource, countryside\n755\t870\t870\tpara\n706\t6528\t839\tsorry, redemption, artwork, clist, claim\n722\t5162\t770\trepair, venom, ship, smell\n116\t100959\t755\tplace, street, time, output, activity, productivity, marketplace, practice, today, specialty, inspection, track, concession, exhibitor, trouble, business, wildlife, festival, removal, wait, step, incentive, career, hotel, haven, consumer, ground, harlingen, note, food, stress, feeder, moment, competitor, news\n981\t1751\t716\tdishwasher, washer, dryer, usernames\n404\t62259\t706\tturtle, information, rental, expo, townhouse, question, greenery, temp, floor, utility, arabic\n163\t19991\t695\tpkwy, misstatement, utopia, january, inaccuracy, december, october, june, flushing, march, tues, birthdate, july, april, february, september, departure, liability\n632\t20687\t678\tgrappler, prime, pseudo, potato, steel, toscano, google, london, cockroach, facebook, inconvenience, attr\n41\t257076\t629\tattic, control, prange, duplex, carpet, prepay, granite, angeles, carpeting, sqft, wayside, cabinetry, lightbox, mover, refundable, knoll, band, vers, countertop, telecom\n100\t8569\t599\tvendor, dispatch, macao, door, evoke, selling\n438\t14452\t581\televe, judy, chen, cheng, renseigne, wallace, senha, ipower, lorenz, fomc, fysisk, ginny, lvmh, musicman, cathy, ister, athos, yuan, mossy, suzano, industrias, larry, chou, diana, jenny, nancy, polar, winnie, neckwarmer, cindy, butik, esqueceu, bacchus, amie, albert, lembrar, fender, jackie\n668\t7089\t580\twashing, nantucket, ingredient, cork, beauty, fulfillment\n390\t40953\t558\trenaissance, room, avail, thanks, hoan, ownership, sofitel\n106\t1953\t551\tbrooklyn, hudson, bronx, westchester\n308\t7567\t544\tcandelabra, torito, montreal, discount, darrin, ritz, pinto, shenanigan\n519\t13978\t474\tcodec, shoveler, sibling, isom, unbind, mastercard, visa, multimedia, logic, drugstore, videogames, overlay, grocery, electronics, scrub, ventilation, swap\n330\t4893\t471\tuseragent, skip, checkin, mlvl, navigator, brate, variable\n764\t19346\t449\tthousand, ipsec, dialog, subforum, leandro, suffix, infringement, autoplay, womens, rancho, logout, auth, json, standalone, remove, grow, handbag\n819\t4122\t449\tvote, deli, oven, fruit\n383\t7035\t439\tfabric, createspace, prestige, myhabit, knitting, computing, photography, indie, comixology, sewing, worldwide, happiness, depository, goodreads\n248\t68438\t417\tquay, heritage, value, chinatown, subcontractor, phuket, california, preference, range, oceanfront\n447\t171142\t397\texpert, license, technology, requirement, precaution, repayment, emergency, development, skill, connection, matter, road, farm, case, safety, ginas, rush, airline, excl, game, demand, difference, dawn, weekly, evangelist, tubing, intr, group, obstacle, junction, deal, college, plan, danger, york, patient, statue, staff, journal, cruise, host, plunge, expansion, independence, summer, electrotherapy, habit, night, yield, thing, resident, citizen, trade, john, commute, risk, warning, star, remind, care, youth, torquay, building, culture, work, gallery, concern, conjunction, viewer, worker, health, hairdressing, organization, stock, support, rock, people, series, challenge, voucher, plate, consigue, uber, point, worry, task, cornholio, course, turf, leaderboard, seminar, effort, student, doormat, bidding, world, kauai, prophet, buddypress, tension, play, friend, company, china, woman, planning, week, merchandise, foundation, guidance, attorney, mind, foursquare, education, tendency, individual, member, hope, pathway, cyber, peace, fort, story, strategy, eyebrow, resolve, lubbock, administration, ability, person, press, tech, life, govt\n657\t18315\t389\twysiwyg, shortcut, hire, realm, furl, handler, controller, variant, thead, alink, heading, zipcode, topline, smid, reqs, kansa, merkle, genome, stack, navigate\n994\t56111\t389\ttrain, physician, mountain, kilometer, light, humanitarian, station, lifestyle, follow, builder, ramp, restaurant, section, couldn, middle, sfml, poly, side, supplement, ballroom, afterschool, christmas, entertainment, condition, relocate, explanation, bargain, video, isbn, money, wrist\n280\t40280\t374\toptometrist, chiropractor, iminent, axel, narod, adoption, config, piping, encoding, minibar, superfish, preroll, binding, sidepanel, doubleclick, blueprint, translate, configuration, checkpoint, timeline, limelight\n967\t52741\t358\tmater, clubhouse, danang, test, agoda, count, blog, house, entrance, samsara\n660\t4696\t357\tplanner, marsha, earning, inevitability, wheelchair, pace, swiss, passenger, mystery, three, pepsi, cure, guideline, pref, interest, dockery\n450\t5730\t345\tbellow, elem, dole, giveaway, kickstart, quant, buzz, lavatory, sofa, token, topside\n136\t3741\t344\tcorporation, pound, reload, panacea, declarative, initialize, prerender, cornucopia, ounce, madrid, delete, distributor\n730\t160358\t328\ttarget, stale, molding, pike, upsell, network, city, carport, laminate, redstone\n655\t1705\t328\texplore, varsity, newsday, sierra, housekeeping\n301\t7804\t326\tchef, tower, eats, lunch, hannibal, blox, typography\n608\t324\t324\tinstance\n796\t6812\t309\tauthenticate, caching, goog, precache, inst, imgs, itms, logging, prefix, response, datepicker, technophobe, autologin, cirrus\n373\t145165\t307\tslot, prevalence, waterfront, bargaining, edgewater, amenity, squid, setblock, wynnewood, benfield, tranquility, state, security, prepayment, event, concierge, cancellation, minecraft\n823\t44198\t301\tanalytics, sticker, invert, citrus, shoping, clorox, toto, collectible, classpath, discrepancy, wattage, dorman, execute, popover, asin, eesti\n298\t3688\t290\tshovel, embed, heating, burner, hamper, canister, drip\n75\t851\t283\tindoors, coupon, hold, arch\n625\t1361\t280\ttape, desk, drink, boredom, backing\n407\t12903\t280\taquarium, card, preparation, centre, prospector, credit, cooler, lover, cooking, corner, definition\n698\t21664\t278\tpublishing, inner, jewellery, zoomin, lovefilm, grok, zoomers, lock, poon, comic, grid, fashion, omni, designer, replace, burj, xref, naver, celebrity, coord, timeperiod\n273\t10804\t278\tphlebotomist, laborer, patience, accuracy, protocall, picker\n912\t61849\t272\towner, jobber, pharmacist, toll, krabi, membership, carving, declaration, problem, fact, gangnam, leaf, report\n669\t4851\t270\tcraftsmanship, register, taste, inbox, notice, myki\n949\t2095\t264\tglare, desktop, desc, mask, doll\n124\t8797\t251\tinserito, modificare, consegna, alla, favore, riesci, risultati, puoi, adatto, siamo, domanda, invia, tardi, ricerca, grado, oppure, stai, momento, clic, risposta, pubblico, chiedi, cercando, errore, verifica, trovare, purtroppo, nascita, stesso, durante, valida\n745\t1520\t245\tolet, expiration, vuotta, tapauksessa, whois, scelte, telnet\n626\t3824\t229\tracking, firefox, backslash, forester, punchout, char, dadada, safari, consolas, pallet, monospace, metadata\n132\t66940\t225\ttable, flinders, gravity, cabin, rate, realty, emporium, substitute, chart\n544\t1132\t224\ttray, lillian, clearfix, openid, overstock, connect\n765\t68874\t222\tbldg, topic, travelodge, minh, saigon, temptation, levittown, highlight, bluebonnet, backpacker, lane, surabaya, abbrev, photo, riverside\n201\t996\t222\tquail, microwave, linen, refrigerator\n690\t8287\t215\tdowntown, brunch, determine, audience, burlington, khao, willingboro, woodbury, cent, headache, collegeville, peddler, tourism, courier, second, referral, seville, chance\n104\t151466\t206\tzestimate, property, atrium, balinese, walking, laundry, spanish, abert, driveway\n217\t291\t204\ttaxi, garbage\n530\t454\t203\tinna, sewer, smoking\n715\t50543\t201\tblessing, infraction, depiction, weather, appointment, benito, november, pride, evening, dinner, bash, tribe, mohammad, recorder, club, gift, impact, shift, flea, store, wasn, personality, advantage, element, memory, puri, guest, antonio, personnel, community, portion, priority, winter, harrisburg, interval, wwii, holiday, breastfeeding, revenue, library, showcase, chicken, badger, reliability\n849\t4091\t198\tsave, qualifying, package\n322\t1797\t198\tcafe, retreat, pool\n478\t17329\t196\tpreload, biking, hamburger, enriquez, jpeg, validator, cameron, conf, fibre, navbar, gram, onmouseover, keyframes, injection, iphones, masquerade\n820\t2571\t193\tdrywall, commerce, comp, carlton, processor, warminster, sconce\n148\t190153\t193\tclosure, sizing, rollout, kind, hospitality, alcohol, dise, king, surgeon, word, barrel, countdown, learning, mayer, appreciation, integrity, caliber, disclosure, rewind, hand, book, topp, mean, pause, energy, resistance, rule, ripper, decode, suit, milestone, reason, subdomain, pine, wind, quality, failure, neighbor, stage, daughter, manner, contributor, criterion, fare, nose, enterprise, monitoring, rest, face, brother, virus, rght, firehouse, need, party, trailer, joyer, love, publisher, wouldn, environment, diamond, stuff, rarity, behaviour, downtime, welder, balloon, dropbox, turn, amity, restoration, ottawa, spot, picture\n576\t14687\t190\tknow, sussex, benefit, merchant, meal, month, leftover, fleet, saving, jules, retweet, billboard, sight, airfare, executive, lottery, cliff\n487\t2903\t189\tstrip, journeyman, backdrop, resume, insert, username, diet, patchwork, threshold, clicking\n552\t8372\t189\tmehron, flash, favicon, palette, querystring, adobe, propeller, dark, opera, playback, yandex, eurasia, celebre\n47\t21099\t185\tfriday, american, religion, morning, pottery, revelation, announcement, flood, aflac, opportunity, retirement, horton, wednesday, river, advance, goal, beginning, confidence, season, shelter, goodwill, snow, timeshares, measure, saddle, expense, similarity, future, intent, boomer, tuesday, yankton, argus, steakhouse, disaster, boost, surfer, timekeeper, university, easton\n751\t19384\t184\tbtree, landing, unit, delivery, shadowbox, complex, crank, enhancement, daily, efficiency, smoke, thought, water, plenty, selection, session\n210\t2602\t181\troof, hiking, nutrition, shade, comfort, bench, kris, stone, single, motorcycle, coffee, briefcase, proof\n783\t13872\t181\tforeman, blackbelt, sloane, furnishing, libs, decorating, join, sprite, webfont\n571\t24648\t179\tdepth, issue, apts, circular, cleanup\n958\t4199\t178\twifi, arrival, comfy, breakfast, turnkey, balcony, lounge, tilt, realtor, paver, shrub\n","comment":"","msgTable":[[{"key":"clusterRating","value":"319"},{"key":"clusterRating","value":"115048"},{"key":"clusterRating","value":"5812"},{"key":"clusterRating","value":"sorenson, affordability, increase, idea, situation, acre, finish, arne, calculator, trend, design, renter, project, process, bathroom, refinance, cost, kitchen, budget"}],[{"key":"median","value":"342"},{"key":"median","value":"20613"},{"key":"median","value":"4944"},{"key":"median","value":"bedding, appraisal, level, razorback, term, privacy"}],[{"key":"words","value":"634"},{"key":"words","value":"12978"},{"key":"words","value":"3088"},{"key":"words","value":"discussion, moxy, look, coverage, berjaya"}],[{"value":"788"},{"value":"33075"},{"value":"2911"},{"value":"dahlia, crabtree, improvement, remodel, accordion, visitor, rating, lanai"}],[{"value":"685"},{"value":"27903"},{"value":"2903"},{"value":"convention, frenzy, finder, foreclosure, buyer, valuation, longview, boro"}],[{"value":"97"},{"value":"29491"},{"value":"2711"},{"value":"banquet, baggage, attendance, zone, elementary, pantera, boundary, ranch, decision, comparison, disclaimer, grade, photocopying"}],[{"value":"939"},{"value":"7463"},{"value":"2708"},{"value":"stub, replay, timing"}],[{"value":"36"},{"value":"51886"},{"value":"2701"},{"value":"capture, rise, tman, bedroom, attention, satellite, mortgage, springhill"}],[{"value":"572"},{"value":"9744"},{"value":"2670"},{"value":"directory, comcast, harbour, forecast, advice"}],[{"value":"374"},{"value":"52898"},{"value":"2497"},{"value":"coldwell, banker, lender, notch, hostel, deck, connecticut, addition, approval, midpoint, guesthouse"}],[{"value":"306"},{"value":"2414"},{"value":"2309"},{"value":"getaway, currency"}],[{"value":"988"},{"value":"2339"},{"value":"2113"},{"value":"storage, iron"}],[{"value":"932"},{"value":"8698"},{"value":"1902"},{"value":"start, option, drain, paste"}],[{"value":"679"},{"value":"6726"},{"value":"1701"},{"value":"keyup, build, blur, invocation"}],[{"value":"388"},{"value":"1643"},{"value":"1630"},{"value":"leisure, nightlife"}],[{"value":"244"},{"value":"8359"},{"value":"1504"},{"value":"relic, boomerang, chan, cust, regexp, addr"}],[{"value":"277"},{"value":"3211"},{"value":"1478"},{"value":"pong, warehouse, crib, promotion"}],[{"value":"164"},{"value":"70342"},{"value":"1478"},{"value":"detail, temperature, bistro, insurance, clarita, dairen"}],[{"value":"448"},{"value":"17654"},{"value":"1275"},{"value":"island, terrace, apartment, lease, surcharge, hanoi, condo, median"}],[{"value":"630"},{"value":"163241"},{"value":"1222"},{"value":"parking, sanam, remax, sand, home, kota, overview"}],[{"value":"893"},{"value":"255630"},{"value":"1216"},{"value":"sudoku, rowland, zillow, sale, walkway, espanol, verizon, apply, canyon, puente, park, pullman"}],[{"value":"806"},{"value":"12892"},{"value":"1190"},{"value":"impression, retrieve, oops, webclient, mousemove, cloudflare, troubleshooting, keydown, oracle, verbose, petok, paragraph"}],[{"value":"54"},{"value":"5277"},{"value":"1183"},{"value":"motoring, hostess, recommendation, studio, tracey, garage"}],[{"value":"178"},{"value":"1549"},{"value":"1093"},{"value":"handmade, gourmet"}],[{"value":"756"},{"value":"1301"},{"value":"1067"},{"value":"questo, della"}],[{"value":"119"},{"value":"4208"},{"value":"1045"},{"value":"horsepower, prop, material, trunk, occupant, drive, generator"}],[{"value":"212"},{"value":"75256"},{"value":"1013"},{"value":"johor, foot, school, estate, peel, circle, villa, category, bungalow"}],[{"value":"881"},{"value":"23916"},{"value":"897"},{"value":"stay, viewing, volcano, connoisseur, jersey, marriott, experiment, illustrator, thesis, grass, player, choice"}],[{"value":"506"},{"value":"85606"},{"value":"894"},{"value":"heat, east, beach, viber, market, recipe, scenery, resource, countryside"}],[{"value":"755"},{"value":"870"},{"value":"870"},{"value":"para"}],[{"value":"706"},{"value":"6528"},{"value":"839"},{"value":"sorry, redemption, artwork, clist, claim"}],[{"value":"722"},{"value":"5162"},{"value":"770"},{"value":"repair, venom, ship, smell"}],[{"value":"116"},{"value":"100959"},{"value":"755"},{"value":"place, street, time, output, activity, productivity, marketplace, practice, today, specialty, inspection, track, concession, exhibitor, trouble, business, wildlife, festival, removal, wait, step, incentive, career, hotel, haven, consumer, ground, harlingen, note, food, stress, feeder, moment, competitor, news"}],[{"value":"981"},{"value":"1751"},{"value":"716"},{"value":"dishwasher, washer, dryer, usernames"}],[{"value":"404"},{"value":"62259"},{"value":"706"},{"value":"turtle, information, rental, expo, townhouse, question, greenery, temp, floor, utility, arabic"}],[{"value":"163"},{"value":"19991"},{"value":"695"},{"value":"pkwy, misstatement, utopia, january, inaccuracy, december, october, june, flushing, march, tues, birthdate, july, april, february, september, departure, liability"}],[{"value":"632"},{"value":"20687"},{"value":"678"},{"value":"grappler, prime, pseudo, potato, steel, toscano, google, london, cockroach, facebook, inconvenience, attr"}],[{"value":"41"},{"value":"257076"},{"value":"629"},{"value":"attic, control, prange, duplex, carpet, prepay, granite, angeles, carpeting, sqft, wayside, cabinetry, lightbox, mover, refundable, knoll, band, vers, countertop, telecom"}],[{"value":"100"},{"value":"8569"},{"value":"599"},{"value":"vendor, dispatch, macao, door, evoke, selling"}],[{"value":"438"},{"value":"14452"},{"value":"581"},{"value":"eleve, judy, chen, cheng, renseigne, wallace, senha, ipower, lorenz, fomc, fysisk, ginny, lvmh, musicman, cathy, ister, athos, yuan, mossy, suzano, industrias, larry, chou, diana, jenny, nancy, polar, winnie, neckwarmer, cindy, butik, esqueceu, bacchus, amie, albert, lembrar, fender, jackie"}],[{"value":"668"},{"value":"7089"},{"value":"580"},{"value":"washing, nantucket, ingredient, cork, beauty, fulfillment"}],[{"value":"390"},{"value":"40953"},{"value":"558"},{"value":"renaissance, room, avail, thanks, hoan, ownership, sofitel"}],[{"value":"106"},{"value":"1953"},{"value":"551"},{"value":"brooklyn, hudson, bronx, westchester"}],[{"value":"308"},{"value":"7567"},{"value":"544"},{"value":"candelabra, torito, montreal, discount, darrin, ritz, pinto, shenanigan"}],[{"value":"519"},{"value":"13978"},{"value":"474"},{"value":"codec, shoveler, sibling, isom, unbind, mastercard, visa, multimedia, logic, drugstore, videogames, overlay, grocery, electronics, scrub, ventilation, swap"}],[{"value":"330"},{"value":"4893"},{"value":"471"},{"value":"useragent, skip, checkin, mlvl, navigator, brate, variable"}],[{"value":"764"},{"value":"19346"},{"value":"449"},{"value":"thousand, ipsec, dialog, subforum, leandro, suffix, infringement, autoplay, womens, rancho, logout, auth, json, standalone, remove, grow, handbag"}],[{"value":"819"},{"value":"4122"},{"value":"449"},{"value":"vote, deli, oven, fruit"}],[{"value":"383"},{"value":"7035"},{"value":"439"},{"value":"fabric, createspace, prestige, myhabit, knitting, computing, photography, indie, comixology, sewing, worldwide, happiness, depository, goodreads"}],[{"value":"248"},{"value":"68438"},{"value":"417"},{"value":"quay, heritage, value, chinatown, subcontractor, phuket, california, preference, range, oceanfront"}],[{"value":"447"},{"value":"171142"},{"value":"397"},{"value":"expert, license, technology, requirement, precaution, repayment, emergency, development, skill, connection, matter, road, farm, case, safety, ginas, rush, airline, excl, game, demand, difference, dawn, weekly, evangelist, tubing, intr, group, obstacle, junction, deal, college, plan, danger, york, patient, statue, staff, journal, cruise, host, plunge, expansion, independence, summer, electrotherapy, habit, night, yield, thing, resident, citizen, trade, john, commute, risk, warning, star, remind, care, youth, torquay, building, culture, work, gallery, concern, conjunction, viewer, worker, health, hairdressing, organization, stock, support, rock, people, series, challenge, voucher, plate, consigue, uber, point, worry, task, cornholio, course, turf, leaderboard, seminar, effort, student, doormat, bidding, world, kauai, prophet, buddypress, tension, play, friend, company, china, woman, planning, week, merchandise, foundation, guidance, attorney, mind, foursquare, education, tendency, individual, member, hope, pathway, cyber, peace, fort, story, strategy, eyebrow, resolve, lubbock, administration, ability, person, press, tech, life, govt"}],[{"value":"657"},{"value":"18315"},{"value":"389"},{"value":"wysiwyg, shortcut, hire, realm, furl, handler, controller, variant, thead, alink, heading, zipcode, topline, smid, reqs, kansa, merkle, genome, stack, navigate"}],[{"value":"994"},{"value":"56111"},{"value":"389"},{"value":"train, physician, mountain, kilometer, light, humanitarian, station, lifestyle, follow, builder, ramp, restaurant, section, couldn, middle, sfml, poly, side, supplement, ballroom, afterschool, christmas, entertainment, condition, relocate, explanation, bargain, video, isbn, money, wrist"}],[{"value":"280"},{"value":"40280"},{"value":"374"},{"value":"optometrist, chiropractor, iminent, axel, narod, adoption, config, piping, encoding, minibar, superfish, preroll, binding, sidepanel, doubleclick, blueprint, translate, configuration, checkpoint, timeline, limelight"}],[{"value":"967"},{"value":"52741"},{"value":"358"},{"value":"mater, clubhouse, danang, test, agoda, count, blog, house, entrance, samsara"}],[{"value":"660"},{"value":"4696"},{"value":"357"},{"value":"planner, marsha, earning, inevitability, wheelchair, pace, swiss, passenger, mystery, three, pepsi, cure, guideline, pref, interest, dockery"}],[{"value":"450"},{"value":"5730"},{"value":"345"},{"value":"bellow, elem, dole, giveaway, kickstart, quant, buzz, lavatory, sofa, token, topside"}],[{"value":"136"},{"value":"3741"},{"value":"344"},{"value":"corporation, pound, reload, panacea, declarative, initialize, prerender, cornucopia, ounce, madrid, delete, distributor"}],[{"value":"730"},{"value":"160358"},{"value":"328"},{"value":"target, stale, molding, pike, upsell, network, city, carport, laminate, redstone"}],[{"value":"655"},{"value":"1705"},{"value":"328"},{"value":"explore, varsity, newsday, sierra, housekeeping"}],[{"value":"301"},{"value":"7804"},{"value":"326"},{"value":"chef, tower, eats, lunch, hannibal, blox, typography"}],[{"value":"608"},{"value":"324"},{"value":"324"},{"value":"instance"}],[{"value":"796"},{"value":"6812"},{"value":"309"},{"value":"authenticate, caching, goog, precache, inst, imgs, itms, logging, prefix, response, datepicker, technophobe, autologin, cirrus"}],[{"value":"373"},{"value":"145165"},{"value":"307"},{"value":"slot, prevalence, waterfront, bargaining, edgewater, amenity, squid, setblock, wynnewood, benfield, tranquility, state, security, prepayment, event, concierge, cancellation, minecraft"}],[{"value":"823"},{"value":"44198"},{"value":"301"},{"value":"analytics, sticker, invert, citrus, shoping, clorox, toto, collectible, classpath, discrepancy, wattage, dorman, execute, popover, asin, eesti"}],[{"value":"298"},{"value":"3688"},{"value":"290"},{"value":"shovel, embed, heating, burner, hamper, canister, drip"}],[{"value":"75"},{"value":"851"},{"value":"283"},{"value":"indoors, coupon, hold, arch"}],[{"value":"625"},{"value":"1361"},{"value":"280"},{"value":"tape, desk, drink, boredom, backing"}],[{"value":"407"},{"value":"12903"},{"value":"280"},{"value":"aquarium, card, preparation, centre, prospector, credit, cooler, lover, cooking, corner, definition"}],[{"value":"698"},{"value":"21664"},{"value":"278"},{"value":"publishing, inner, jewellery, zoomin, lovefilm, grok, zoomers, lock, poon, comic, grid, fashion, omni, designer, replace, burj, xref, naver, celebrity, coord, timeperiod"}],[{"value":"273"},{"value":"10804"},{"value":"278"},{"value":"phlebotomist, laborer, patience, accuracy, protocall, picker"}],[{"value":"912"},{"value":"61849"},{"value":"272"},{"value":"owner, jobber, pharmacist, toll, krabi, membership, carving, declaration, problem, fact, gangnam, leaf, report"}],[{"value":"669"},{"value":"4851"},{"value":"270"},{"value":"craftsmanship, register, taste, inbox, notice, myki"}],[{"value":"949"},{"value":"2095"},{"value":"264"},{"value":"glare, desktop, desc, mask, doll"}],[{"value":"124"},{"value":"8797"},{"value":"251"},{"value":"inserito, modificare, consegna, alla, favore, riesci, risultati, puoi, adatto, siamo, domanda, invia, tardi, ricerca, grado, oppure, stai, momento, clic, risposta, pubblico, chiedi, cercando, errore, verifica, trovare, purtroppo, nascita, stesso, durante, valida"}],[{"value":"745"},{"value":"1520"},{"value":"245"},{"value":"olet, expiration, vuotta, tapauksessa, whois, scelte, telnet"}],[{"value":"626"},{"value":"3824"},{"value":"229"},{"value":"racking, firefox, backslash, forester, punchout, char, dadada, safari, consolas, pallet, monospace, metadata"}],[{"value":"132"},{"value":"66940"},{"value":"225"},{"value":"table, flinders, gravity, cabin, rate, realty, emporium, substitute, chart"}],[{"value":"544"},{"value":"1132"},{"value":"224"},{"value":"tray, lillian, clearfix, openid, overstock, connect"}],[{"value":"765"},{"value":"68874"},{"value":"222"},{"value":"bldg, topic, travelodge, minh, saigon, temptation, levittown, highlight, bluebonnet, backpacker, lane, surabaya, abbrev, photo, riverside"}],[{"value":"201"},{"value":"996"},{"value":"222"},{"value":"quail, microwave, linen, refrigerator"}],[{"value":"690"},{"value":"8287"},{"value":"215"},{"value":"downtown, brunch, determine, audience, burlington, khao, willingboro, woodbury, cent, headache, collegeville, peddler, tourism, courier, second, referral, seville, chance"}],[{"value":"104"},{"value":"151466"},{"value":"206"},{"value":"zestimate, property, atrium, balinese, walking, laundry, spanish, abert, driveway"}],[{"value":"217"},{"value":"291"},{"value":"204"},{"value":"taxi, garbage"}],[{"value":"530"},{"value":"454"},{"value":"203"},{"value":"inna, sewer, smoking"}],[{"value":"715"},{"value":"50543"},{"value":"201"},{"value":"blessing, infraction, depiction, weather, appointment, benito, november, pride, evening, dinner, bash, tribe, mohammad, recorder, club, gift, impact, shift, flea, store, wasn, personality, advantage, element, memory, puri, guest, antonio, personnel, community, portion, priority, winter, harrisburg, interval, wwii, holiday, breastfeeding, revenue, library, showcase, chicken, badger, reliability"}],[{"value":"849"},{"value":"4091"},{"value":"198"},{"value":"save, qualifying, package"}],[{"value":"322"},{"value":"1797"},{"value":"198"},{"value":"cafe, retreat, pool"}],[{"value":"478"},{"value":"17329"},{"value":"196"},{"value":"preload, biking, hamburger, enriquez, jpeg, validator, cameron, conf, fibre, navbar, gram, onmouseover, keyframes, injection, iphones, masquerade"}],[{"value":"820"},{"value":"2571"},{"value":"193"},{"value":"drywall, commerce, comp, carlton, processor, warminster, sconce"}],[{"value":"148"},{"value":"190153"},{"value":"193"},{"value":"closure, sizing, rollout, kind, hospitality, alcohol, dise, king, surgeon, word, barrel, countdown, learning, mayer, appreciation, integrity, caliber, disclosure, rewind, hand, book, topp, mean, pause, energy, resistance, rule, ripper, decode, suit, milestone, reason, subdomain, pine, wind, quality, failure, neighbor, stage, daughter, manner, contributor, criterion, fare, nose, enterprise, monitoring, rest, face, brother, virus, rght, firehouse, need, party, trailer, joyer, love, publisher, wouldn, environment, diamond, stuff, rarity, behaviour, downtime, welder, balloon, dropbox, turn, amity, restoration, ottawa, spot, picture"}],[{"value":"576"},{"value":"14687"},{"value":"190"},{"value":"know, sussex, benefit, merchant, meal, month, leftover, fleet, saving, jules, retweet, billboard, sight, airfare, executive, lottery, cliff"}],[{"value":"487"},{"value":"2903"},{"value":"189"},{"value":"strip, journeyman, backdrop, resume, insert, username, diet, patchwork, threshold, clicking"}],[{"value":"552"},{"value":"8372"},{"value":"189"},{"value":"mehron, flash, favicon, palette, querystring, adobe, propeller, dark, opera, playback, yandex, eurasia, celebre"}],[{"value":"47"},{"value":"21099"},{"value":"185"},{"value":"friday, american, religion, morning, pottery, revelation, announcement, flood, aflac, opportunity, retirement, horton, wednesday, river, advance, goal, beginning, confidence, season, shelter, goodwill, snow, timeshares, measure, saddle, expense, similarity, future, intent, boomer, tuesday, yankton, argus, steakhouse, disaster, boost, surfer, timekeeper, university, easton"}],[{"value":"751"},{"value":"19384"},{"value":"184"},{"value":"btree, landing, unit, delivery, shadowbox, complex, crank, enhancement, daily, efficiency, smoke, thought, water, plenty, selection, session"}],[{"value":"210"},{"value":"2602"},{"value":"181"},{"value":"roof, hiking, nutrition, shade, comfort, bench, kris, stone, single, motorcycle, coffee, briefcase, proof"}],[{"value":"783"},{"value":"13872"},{"value":"181"},{"value":"foreman, blackbelt, sloane, furnishing, libs, decorating, join, sprite, webfont"}],[{"value":"571"},{"value":"24648"},{"value":"179"},{"value":"depth, issue, apts, circular, cleanup"}],[{"value":"958"},{"value":"4199"},{"value":"178"},{"value":"wifi, arrival, comfy, breakfast, turnkey, balcony, lounge, tilt, realtor, paver, shrub"}]],"columnNames":[{"name":"clusterId","index":0,"aggr":"sum"},{"name":"clusterRating","index":1,"aggr":"sum"},{"name":"median","index":2,"aggr":"sum"},{"name":"words","index":3,"aggr":"sum"}],"rows":[["319","115048","5812","sorenson, affordability, increase, idea, situation, acre, finish, arne, calculator, trend, design, renter, project, process, bathroom, refinance, cost, kitchen, budget"],["342","20613","4944","bedding, appraisal, level, razorback, term, privacy"],["634","12978","3088","discussion, moxy, look, coverage, berjaya"],["788","33075","2911","dahlia, crabtree, improvement, remodel, accordion, visitor, rating, lanai"],["685","27903","2903","convention, frenzy, finder, foreclosure, buyer, valuation, longview, boro"],["97","29491","2711","banquet, baggage, attendance, zone, elementary, pantera, boundary, ranch, decision, comparison, disclaimer, grade, photocopying"],["939","7463","2708","stub, replay, timing"],["36","51886","2701","capture, rise, tman, bedroom, attention, satellite, mortgage, springhill"],["572","9744","2670","directory, comcast, harbour, forecast, advice"],["374","52898","2497","coldwell, banker, lender, notch, hostel, deck, connecticut, addition, approval, midpoint, guesthouse"],["306","2414","2309","getaway, currency"],["988","2339","2113","storage, iron"],["932","8698","1902","start, option, drain, paste"],["679","6726","1701","keyup, build, blur, invocation"],["388","1643","1630","leisure, nightlife"],["244","8359","1504","relic, boomerang, chan, cust, regexp, addr"],["277","3211","1478","pong, warehouse, crib, promotion"],["164","70342","1478","detail, temperature, bistro, insurance, clarita, dairen"],["448","17654","1275","island, terrace, apartment, lease, surcharge, hanoi, condo, median"],["630","163241","1222","parking, sanam, remax, sand, home, kota, overview"],["893","255630","1216","sudoku, rowland, zillow, sale, walkway, espanol, verizon, apply, canyon, puente, park, pullman"],["806","12892","1190","impression, retrieve, oops, webclient, mousemove, cloudflare, troubleshooting, keydown, oracle, verbose, petok, paragraph"],["54","5277","1183","motoring, hostess, recommendation, studio, tracey, garage"],["178","1549","1093","handmade, gourmet"],["756","1301","1067","questo, della"],["119","4208","1045","horsepower, prop, material, trunk, occupant, drive, generator"],["212","75256","1013","johor, foot, school, estate, peel, circle, villa, category, bungalow"],["881","23916","897","stay, viewing, volcano, connoisseur, jersey, marriott, experiment, illustrator, thesis, grass, player, choice"],["506","85606","894","heat, east, beach, viber, market, recipe, scenery, resource, countryside"],["755","870","870","para"],["706","6528","839","sorry, redemption, artwork, clist, claim"],["722","5162","770","repair, venom, ship, smell"],["116","100959","755","place, street, time, output, activity, productivity, marketplace, practice, today, specialty, inspection, track, concession, exhibitor, trouble, business, wildlife, festival, removal, wait, step, incentive, career, hotel, haven, consumer, ground, harlingen, note, food, stress, feeder, moment, competitor, news"],["981","1751","716","dishwasher, washer, dryer, usernames"],["404","62259","706","turtle, information, rental, expo, townhouse, question, greenery, temp, floor, utility, arabic"],["163","19991","695","pkwy, misstatement, utopia, january, inaccuracy, december, october, june, flushing, march, tues, birthdate, july, april, february, september, departure, liability"],["632","20687","678","grappler, prime, pseudo, potato, steel, toscano, google, london, cockroach, facebook, inconvenience, attr"],["41","257076","629","attic, control, prange, duplex, carpet, prepay, granite, angeles, carpeting, sqft, wayside, cabinetry, lightbox, mover, refundable, knoll, band, vers, countertop, telecom"],["100","8569","599","vendor, dispatch, macao, door, evoke, selling"],["438","14452","581","eleve, judy, chen, cheng, renseigne, wallace, senha, ipower, lorenz, fomc, fysisk, ginny, lvmh, musicman, cathy, ister, athos, yuan, mossy, suzano, industrias, larry, chou, diana, jenny, nancy, polar, winnie, neckwarmer, cindy, butik, esqueceu, bacchus, amie, albert, lembrar, fender, jackie"],["668","7089","580","washing, nantucket, ingredient, cork, beauty, fulfillment"],["390","40953","558","renaissance, room, avail, thanks, hoan, ownership, sofitel"],["106","1953","551","brooklyn, hudson, bronx, westchester"],["308","7567","544","candelabra, torito, montreal, discount, darrin, ritz, pinto, shenanigan"],["519","13978","474","codec, shoveler, sibling, isom, unbind, mastercard, visa, multimedia, logic, drugstore, videogames, overlay, grocery, electronics, scrub, ventilation, swap"],["330","4893","471","useragent, skip, checkin, mlvl, navigator, brate, variable"],["764","19346","449","thousand, ipsec, dialog, subforum, leandro, suffix, infringement, autoplay, womens, rancho, logout, auth, json, standalone, remove, grow, handbag"],["819","4122","449","vote, deli, oven, fruit"],["383","7035","439","fabric, createspace, prestige, myhabit, knitting, computing, photography, indie, comixology, sewing, worldwide, happiness, depository, goodreads"],["248","68438","417","quay, heritage, value, chinatown, subcontractor, phuket, california, preference, range, oceanfront"],["447","171142","397","expert, license, technology, requirement, precaution, repayment, emergency, development, skill, connection, matter, road, farm, case, safety, ginas, rush, airline, excl, game, demand, difference, dawn, weekly, evangelist, tubing, intr, group, obstacle, junction, deal, college, plan, danger, york, patient, statue, staff, journal, cruise, host, plunge, expansion, independence, summer, electrotherapy, habit, night, yield, thing, resident, citizen, trade, john, commute, risk, warning, star, remind, care, youth, torquay, building, culture, work, gallery, concern, conjunction, viewer, worker, health, hairdressing, organization, stock, support, rock, people, series, challenge, voucher, plate, consigue, uber, point, worry, task, cornholio, course, turf, leaderboard, seminar, effort, student, doormat, bidding, world, kauai, prophet, buddypress, tension, play, friend, company, china, woman, planning, week, merchandise, foundation, guidance, attorney, mind, foursquare, education, tendency, individual, member, hope, pathway, cyber, peace, fort, story, strategy, eyebrow, resolve, lubbock, administration, ability, person, press, tech, life, govt"],["657","18315","389","wysiwyg, shortcut, hire, realm, furl, handler, controller, variant, thead, alink, heading, zipcode, topline, smid, reqs, kansa, merkle, genome, stack, navigate"],["994","56111","389","train, physician, mountain, kilometer, light, humanitarian, station, lifestyle, follow, builder, ramp, restaurant, section, couldn, middle, sfml, poly, side, supplement, ballroom, afterschool, christmas, entertainment, condition, relocate, explanation, bargain, video, isbn, money, wrist"],["280","40280","374","optometrist, chiropractor, iminent, axel, narod, adoption, config, piping, encoding, minibar, superfish, preroll, binding, sidepanel, doubleclick, blueprint, translate, configuration, checkpoint, timeline, limelight"],["967","52741","358","mater, clubhouse, danang, test, agoda, count, blog, house, entrance, samsara"],["660","4696","357","planner, marsha, earning, inevitability, wheelchair, pace, swiss, passenger, mystery, three, pepsi, cure, guideline, pref, interest, dockery"],["450","5730","345","bellow, elem, dole, giveaway, kickstart, quant, buzz, lavatory, sofa, token, topside"],["136","3741","344","corporation, pound, reload, panacea, declarative, initialize, prerender, cornucopia, ounce, madrid, delete, distributor"],["730","160358","328","target, stale, molding, pike, upsell, network, city, carport, laminate, redstone"],["655","1705","328","explore, varsity, newsday, sierra, housekeeping"],["301","7804","326","chef, tower, eats, lunch, hannibal, blox, typography"],["608","324","324","instance"],["796","6812","309","authenticate, caching, goog, precache, inst, imgs, itms, logging, prefix, response, datepicker, technophobe, autologin, cirrus"],["373","145165","307","slot, prevalence, waterfront, bargaining, edgewater, amenity, squid, setblock, wynnewood, benfield, tranquility, state, security, prepayment, event, concierge, cancellation, minecraft"],["823","44198","301","analytics, sticker, invert, citrus, shoping, clorox, toto, collectible, classpath, discrepancy, wattage, dorman, execute, popover, asin, eesti"],["298","3688","290","shovel, embed, heating, burner, hamper, canister, drip"],["75","851","283","indoors, coupon, hold, arch"],["625","1361","280","tape, desk, drink, boredom, backing"],["407","12903","280","aquarium, card, preparation, centre, prospector, credit, cooler, lover, cooking, corner, definition"],["698","21664","278","publishing, inner, jewellery, zoomin, lovefilm, grok, zoomers, lock, poon, comic, grid, fashion, omni, designer, replace, burj, xref, naver, celebrity, coord, timeperiod"],["273","10804","278","phlebotomist, laborer, patience, accuracy, protocall, picker"],["912","61849","272","owner, jobber, pharmacist, toll, krabi, membership, carving, declaration, problem, fact, gangnam, leaf, report"],["669","4851","270","craftsmanship, register, taste, inbox, notice, myki"],["949","2095","264","glare, desktop, desc, mask, doll"],["124","8797","251","inserito, modificare, consegna, alla, favore, riesci, risultati, puoi, adatto, siamo, domanda, invia, tardi, ricerca, grado, oppure, stai, momento, clic, risposta, pubblico, chiedi, cercando, errore, verifica, trovare, purtroppo, nascita, stesso, durante, valida"],["745","1520","245","olet, expiration, vuotta, tapauksessa, whois, scelte, telnet"],["626","3824","229","racking, firefox, backslash, forester, punchout, char, dadada, safari, consolas, pallet, monospace, metadata"],["132","66940","225","table, flinders, gravity, cabin, rate, realty, emporium, substitute, chart"],["544","1132","224","tray, lillian, clearfix, openid, overstock, connect"],["765","68874","222","bldg, topic, travelodge, minh, saigon, temptation, levittown, highlight, bluebonnet, backpacker, lane, surabaya, abbrev, photo, riverside"],["201","996","222","quail, microwave, linen, refrigerator"],["690","8287","215","downtown, brunch, determine, audience, burlington, khao, willingboro, woodbury, cent, headache, collegeville, peddler, tourism, courier, second, referral, seville, chance"],["104","151466","206","zestimate, property, atrium, balinese, walking, laundry, spanish, abert, driveway"],["217","291","204","taxi, garbage"],["530","454","203","inna, sewer, smoking"],["715","50543","201","blessing, infraction, depiction, weather, appointment, benito, november, pride, evening, dinner, bash, tribe, mohammad, recorder, club, gift, impact, shift, flea, store, wasn, personality, advantage, element, memory, puri, guest, antonio, personnel, community, portion, priority, winter, harrisburg, interval, wwii, holiday, breastfeeding, revenue, library, showcase, chicken, badger, reliability"],["849","4091","198","save, qualifying, package"],["322","1797","198","cafe, retreat, pool"],["478","17329","196","preload, biking, hamburger, enriquez, jpeg, validator, cameron, conf, fibre, navbar, gram, onmouseover, keyframes, injection, iphones, masquerade"],["820","2571","193","drywall, commerce, comp, carlton, processor, warminster, sconce"],["148","190153","193","closure, sizing, rollout, kind, hospitality, alcohol, dise, king, surgeon, word, barrel, countdown, learning, mayer, appreciation, integrity, caliber, disclosure, rewind, hand, book, topp, mean, pause, energy, resistance, rule, ripper, decode, suit, milestone, reason, subdomain, pine, wind, quality, failure, neighbor, stage, daughter, manner, contributor, criterion, fare, nose, enterprise, monitoring, rest, face, brother, virus, rght, firehouse, need, party, trailer, joyer, love, publisher, wouldn, environment, diamond, stuff, rarity, behaviour, downtime, welder, balloon, dropbox, turn, amity, restoration, ottawa, spot, picture"],["576","14687","190","know, sussex, benefit, merchant, meal, month, leftover, fleet, saving, jules, retweet, billboard, sight, airfare, executive, lottery, cliff"],["487","2903","189","strip, journeyman, backdrop, resume, insert, username, diet, patchwork, threshold, clicking"],["552","8372","189","mehron, flash, favicon, palette, querystring, adobe, propeller, dark, opera, playback, yandex, eurasia, celebre"],["47","21099","185","friday, american, religion, morning, pottery, revelation, announcement, flood, aflac, opportunity, retirement, horton, wednesday, river, advance, goal, beginning, confidence, season, shelter, goodwill, snow, timeshares, measure, saddle, expense, similarity, future, intent, boomer, tuesday, yankton, argus, steakhouse, disaster, boost, surfer, timekeeper, university, easton"],["751","19384","184","btree, landing, unit, delivery, shadowbox, complex, crank, enhancement, daily, efficiency, smoke, thought, water, plenty, selection, session"],["210","2602","181","roof, hiking, nutrition, shade, comfort, bench, kris, stone, single, motorcycle, coffee, briefcase, proof"],["783","13872","181","foreman, blackbelt, sloane, furnishing, libs, decorating, join, sprite, webfont"],["571","24648","179","depth, issue, apts, circular, cleanup"],["958","4199","178","wifi, arrival, comfy, breakfast, turnkey, balcony, lounge, tilt, realtor, paver, shrub"]]},"dateCreated":"Feb 22, 2016 9:08:53 PM","dateStarted":"Feb 24, 2016 7:58:05 PM","dateFinished":"Feb 24, 2016 7:58:14 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30"},{"text":"%sql\nselect  ws.clusterId, sum(ws.f) as clusterRating , cm.median ,cd.words\n    from WordStats ws \n    join ClusterWords cd on ws.clusterId = cd.clusterId\n    join ClustersMedian cm on ws.clusterId = cm.clusterId\n\nwhere cd.words like '%porn%' \n    or cd.words like '%sex%' \ngroup by ws.clusterId,  cm.median, cd.words\norder by  cm.median DESC","dateUpdated":"Feb 27, 2016 11:29:33 PM","config":{"colWidth":12,"graph":{"mode":"table","height":475,"optionOpen":false,"keys":[{"name":"clusterId","index":0,"aggr":"sum"}],"values":[{"name":"clusterRating","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"clusterId","index":0,"aggr":"sum"},"yAxis":{"name":"clusterRating","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456165114424_1057244837","id":"20160222-211834_2123654585","result":{"code":"SUCCESS","type":"TABLE","msg":"clusterId\tclusterRating\tmedian\twords\n576\t14687\t190\tknow, sussex, benefit, merchant, meal, month, leftover, fleet, saving, jules, retweet, billboard, sight, airfare, executive, lottery, cliff\n417\t11613\t57\ttwinks, femdom, cougar, booty, cece, milf, ladyboy, bitch, teenage, cutie, mistress, blonde, dude, threesome, blowjob, horny, andie, matures, melon, bombshell, fishnet, japanese, asshole, milfs, pantyhose, fuckin, cumshot, latex, dressing, petite, rubbing, amateur, lust, stepmom, boobed, creampie, suck, backroom, doggystyle, throat, bimbo, shemale, nudity, rimjob, lesbian, lingerie, masturbation, incest, butt, toying, crossdresser, facial, grannie, virgin, pornhub, troia, teeny, upskirt, puta, whore, hunk, stle, exhibitionist, vixen, stepdaughter, pantie, katarina, cunt, gangbang, asian, hardcore, seduction, assfuck, pussy, chubby, bondage, blond, handjob, doggy, babysitter, deepthroat, lactating, mommy, homemade, teenie, slut, aunty, orgasm, lick, teenies, squirt, stepson, cuckold, vibrator, parlor, panty, seduces, fucking, housewife, lolita, bigass, fuck, chaussures, hottie, latina, dong, fetish, twink, twat, cameltoe, cumshots, kissing, titjob, granny, babe, ivana, tease, softcore, penetration, taboo, titty, casting, nipple, fisting, ebony, mexicana, brunette, boob, orgy, dildo, webcam, teasing, cock, caning, coed, sextape, hooker, handjobs, masturbates, swinger, salope, chick, schoolgirl, clit, saggy, slutty, humiliation, mature, midget, buttplug, fucker, busty, redhead, bareback, desi, tranny, tongue, compilation, bukkake, virginity\n704\t7818\t48\tprowess, pornography, clarity, novel, evaluation, exploration, charlie, country, achievement, occurrence, gala, actor, megastar, harmony, stepfather, statistic, yify, interview, mankind, charles, plus, ralph, drama, tappan, anon, grant\n79\t1600\t44\tatom, rearrange, backwheel, sealant, softlines, unisex, servername, additive, paget, minnie, disney, lithium, detector, blogspot, suid, gasket, roku, touchscreen, analyzer, glue, mickey, headend, jumbo, blogger, sealer, lube, recliner, cordless, adhesive, noscript, rejuvenation\n879\t1203\t42\tcouch, vignette, mouth, hailey, glam, moan, stickam, cucumber, juggs, maniac, biker, breeding, omegle, chastity, domination, jizz, maid, pornstar, pornstars, creme, popsicle, bdsm, sexshop, torture, stewardess, bikini\n203\t309\t24\ttranssexual, casserole, vagina, embellishment, shemales, maison, transexual, veronica, striptease, sperm, semen, strapon, stripper, partie\n131\t1811\t22\tautosuggest, nerd, nido, runtime, tube, sled, porno, flesh, cranberry, hydroquinone, travelocity, buyable, quintillion, sharpener, xvideos\n999\t605\t22\trogan, crevice, quicksilver, diver, toothpaste, whiplash, archiver, here, tapestry, deze, chute, tablename, kingston, sexo, jaipur, elle\n938\t1690\t20\tshaft, bourbon, acct, cashback, flap, porn, screenname, demo, esrb, compressor, pivot, standardise, circumference, cleanse\n550\t1219\t20\tgiga, fabricator, sexi, anpassen, magpie, scrie, titanium, samsonite, fresco, diametre, rotor, brandi, bound, dance\n365\t862\t19\tfitzpatrick, congressman, tyra, bandung, restitution, slum, gino, negativity, dago, jati, nairobi, trump, cebu, pasteur, donald, candidacy, braga, eyewitness, hearthstone, riau, sexism, damar\n990\t563\t17\tabatement, stephen, panic, magician, minimise, blaise, supergirl, cecil, mythology, tarantino, sprint, robi, haunt, isabella, falcon, seymour, essex, adam, boyd, feud, antivirus, kidney\n797\t401\t14\tdiarrhea, greenwich, demarco, sexuality, jocelyn, idiot, swamp, isolation, bonfire, malaria, holland, sawmill, mojo, klonopin, grail, criminology, lori, bhutan, citibank, phillips, southeast\n863\t1210\t12\tmadchen, urethane, lacquer, flipbook, strada, zeon, youporn, fick\n957\t116\t9\trahway, snowbird, holloway, morristown, workbook, bodysuit, infantry, middlesex, anarchism, tome, hungarian\n","comment":"","msgTable":[[{"key":"clusterRating","value":"576"},{"key":"clusterRating","value":"14687"},{"key":"clusterRating","value":"190"},{"key":"clusterRating","value":"know, sussex, benefit, merchant, meal, month, leftover, fleet, saving, jules, retweet, billboard, sight, airfare, executive, lottery, cliff"}],[{"key":"median","value":"417"},{"key":"median","value":"11613"},{"key":"median","value":"57"},{"key":"median","value":"twinks, femdom, cougar, booty, cece, milf, ladyboy, bitch, teenage, cutie, mistress, blonde, dude, threesome, blowjob, horny, andie, matures, melon, bombshell, fishnet, japanese, asshole, milfs, pantyhose, fuckin, cumshot, latex, dressing, petite, rubbing, amateur, lust, stepmom, boobed, creampie, suck, backroom, doggystyle, throat, bimbo, shemale, nudity, rimjob, lesbian, lingerie, masturbation, incest, butt, toying, crossdresser, facial, grannie, virgin, pornhub, troia, teeny, upskirt, puta, whore, hunk, stle, exhibitionist, vixen, stepdaughter, pantie, katarina, cunt, gangbang, asian, hardcore, seduction, assfuck, pussy, chubby, bondage, blond, handjob, doggy, babysitter, deepthroat, lactating, mommy, homemade, teenie, slut, aunty, orgasm, lick, teenies, squirt, stepson, cuckold, vibrator, parlor, panty, seduces, fucking, housewife, lolita, bigass, fuck, chaussures, hottie, latina, dong, fetish, twink, twat, cameltoe, cumshots, kissing, titjob, granny, babe, ivana, tease, softcore, penetration, taboo, titty, casting, nipple, fisting, ebony, mexicana, brunette, boob, orgy, dildo, webcam, teasing, cock, caning, coed, sextape, hooker, handjobs, masturbates, swinger, salope, chick, schoolgirl, clit, saggy, slutty, humiliation, mature, midget, buttplug, fucker, busty, redhead, bareback, desi, tranny, tongue, compilation, bukkake, virginity"}],[{"key":"words","value":"704"},{"key":"words","value":"7818"},{"key":"words","value":"48"},{"key":"words","value":"prowess, pornography, clarity, novel, evaluation, exploration, charlie, country, achievement, occurrence, gala, actor, megastar, harmony, stepfather, statistic, yify, interview, mankind, charles, plus, ralph, drama, tappan, anon, grant"}],[{"value":"79"},{"value":"1600"},{"value":"44"},{"value":"atom, rearrange, backwheel, sealant, softlines, unisex, servername, additive, paget, minnie, disney, lithium, detector, blogspot, suid, gasket, roku, touchscreen, analyzer, glue, mickey, headend, jumbo, blogger, sealer, lube, recliner, cordless, adhesive, noscript, rejuvenation"}],[{"value":"879"},{"value":"1203"},{"value":"42"},{"value":"couch, vignette, mouth, hailey, glam, moan, stickam, cucumber, juggs, maniac, biker, breeding, omegle, chastity, domination, jizz, maid, pornstar, pornstars, creme, popsicle, bdsm, sexshop, torture, stewardess, bikini"}],[{"value":"203"},{"value":"309"},{"value":"24"},{"value":"transsexual, casserole, vagina, embellishment, shemales, maison, transexual, veronica, striptease, sperm, semen, strapon, stripper, partie"}],[{"value":"131"},{"value":"1811"},{"value":"22"},{"value":"autosuggest, nerd, nido, runtime, tube, sled, porno, flesh, cranberry, hydroquinone, travelocity, buyable, quintillion, sharpener, xvideos"}],[{"value":"999"},{"value":"605"},{"value":"22"},{"value":"rogan, crevice, quicksilver, diver, toothpaste, whiplash, archiver, here, tapestry, deze, chute, tablename, kingston, sexo, jaipur, elle"}],[{"value":"938"},{"value":"1690"},{"value":"20"},{"value":"shaft, bourbon, acct, cashback, flap, porn, screenname, demo, esrb, compressor, pivot, standardise, circumference, cleanse"}],[{"value":"550"},{"value":"1219"},{"value":"20"},{"value":"giga, fabricator, sexi, anpassen, magpie, scrie, titanium, samsonite, fresco, diametre, rotor, brandi, bound, dance"}],[{"value":"365"},{"value":"862"},{"value":"19"},{"value":"fitzpatrick, congressman, tyra, bandung, restitution, slum, gino, negativity, dago, jati, nairobi, trump, cebu, pasteur, donald, candidacy, braga, eyewitness, hearthstone, riau, sexism, damar"}],[{"value":"990"},{"value":"563"},{"value":"17"},{"value":"abatement, stephen, panic, magician, minimise, blaise, supergirl, cecil, mythology, tarantino, sprint, robi, haunt, isabella, falcon, seymour, essex, adam, boyd, feud, antivirus, kidney"}],[{"value":"797"},{"value":"401"},{"value":"14"},{"value":"diarrhea, greenwich, demarco, sexuality, jocelyn, idiot, swamp, isolation, bonfire, malaria, holland, sawmill, mojo, klonopin, grail, criminology, lori, bhutan, citibank, phillips, southeast"}],[{"value":"863"},{"value":"1210"},{"value":"12"},{"value":"madchen, urethane, lacquer, flipbook, strada, zeon, youporn, fick"}],[{"value":"957"},{"value":"116"},{"value":"9"},{"value":"rahway, snowbird, holloway, morristown, workbook, bodysuit, infantry, middlesex, anarchism, tome, hungarian"}]],"columnNames":[{"name":"clusterId","index":0,"aggr":"sum"},{"name":"clusterRating","index":1,"aggr":"sum"},{"name":"median","index":2,"aggr":"sum"},{"name":"words","index":3,"aggr":"sum"}],"rows":[["576","14687","190","know, sussex, benefit, merchant, meal, month, leftover, fleet, saving, jules, retweet, billboard, sight, airfare, executive, lottery, cliff"],["417","11613","57","twinks, femdom, cougar, booty, cece, milf, ladyboy, bitch, teenage, cutie, mistress, blonde, dude, threesome, blowjob, horny, andie, matures, melon, bombshell, fishnet, japanese, asshole, milfs, pantyhose, fuckin, cumshot, latex, dressing, petite, rubbing, amateur, lust, stepmom, boobed, creampie, suck, backroom, doggystyle, throat, bimbo, shemale, nudity, rimjob, lesbian, lingerie, masturbation, incest, butt, toying, crossdresser, facial, grannie, virgin, pornhub, troia, teeny, upskirt, puta, whore, hunk, stle, exhibitionist, vixen, stepdaughter, pantie, katarina, cunt, gangbang, asian, hardcore, seduction, assfuck, pussy, chubby, bondage, blond, handjob, doggy, babysitter, deepthroat, lactating, mommy, homemade, teenie, slut, aunty, orgasm, lick, teenies, squirt, stepson, cuckold, vibrator, parlor, panty, seduces, fucking, housewife, lolita, bigass, fuck, chaussures, hottie, latina, dong, fetish, twink, twat, cameltoe, cumshots, kissing, titjob, granny, babe, ivana, tease, softcore, penetration, taboo, titty, casting, nipple, fisting, ebony, mexicana, brunette, boob, orgy, dildo, webcam, teasing, cock, caning, coed, sextape, hooker, handjobs, masturbates, swinger, salope, chick, schoolgirl, clit, saggy, slutty, humiliation, mature, midget, buttplug, fucker, busty, redhead, bareback, desi, tranny, tongue, compilation, bukkake, virginity"],["704","7818","48","prowess, pornography, clarity, novel, evaluation, exploration, charlie, country, achievement, occurrence, gala, actor, megastar, harmony, stepfather, statistic, yify, interview, mankind, charles, plus, ralph, drama, tappan, anon, grant"],["79","1600","44","atom, rearrange, backwheel, sealant, softlines, unisex, servername, additive, paget, minnie, disney, lithium, detector, blogspot, suid, gasket, roku, touchscreen, analyzer, glue, mickey, headend, jumbo, blogger, sealer, lube, recliner, cordless, adhesive, noscript, rejuvenation"],["879","1203","42","couch, vignette, mouth, hailey, glam, moan, stickam, cucumber, juggs, maniac, biker, breeding, omegle, chastity, domination, jizz, maid, pornstar, pornstars, creme, popsicle, bdsm, sexshop, torture, stewardess, bikini"],["203","309","24","transsexual, casserole, vagina, embellishment, shemales, maison, transexual, veronica, striptease, sperm, semen, strapon, stripper, partie"],["131","1811","22","autosuggest, nerd, nido, runtime, tube, sled, porno, flesh, cranberry, hydroquinone, travelocity, buyable, quintillion, sharpener, xvideos"],["999","605","22","rogan, crevice, quicksilver, diver, toothpaste, whiplash, archiver, here, tapestry, deze, chute, tablename, kingston, sexo, jaipur, elle"],["938","1690","20","shaft, bourbon, acct, cashback, flap, porn, screenname, demo, esrb, compressor, pivot, standardise, circumference, cleanse"],["550","1219","20","giga, fabricator, sexi, anpassen, magpie, scrie, titanium, samsonite, fresco, diametre, rotor, brandi, bound, dance"],["365","862","19","fitzpatrick, congressman, tyra, bandung, restitution, slum, gino, negativity, dago, jati, nairobi, trump, cebu, pasteur, donald, candidacy, braga, eyewitness, hearthstone, riau, sexism, damar"],["990","563","17","abatement, stephen, panic, magician, minimise, blaise, supergirl, cecil, mythology, tarantino, sprint, robi, haunt, isabella, falcon, seymour, essex, adam, boyd, feud, antivirus, kidney"],["797","401","14","diarrhea, greenwich, demarco, sexuality, jocelyn, idiot, swamp, isolation, bonfire, malaria, holland, sawmill, mojo, klonopin, grail, criminology, lori, bhutan, citibank, phillips, southeast"],["863","1210","12","madchen, urethane, lacquer, flipbook, strada, zeon, youporn, fick"],["957","116","9","rahway, snowbird, holloway, morristown, workbook, bodysuit, infantry, middlesex, anarchism, tome, hungarian"]]},"dateCreated":"Feb 22, 2016 9:18:34 PM","dateStarted":"Feb 27, 2016 11:29:33 PM","dateFinished":"Feb 27, 2016 11:29:53 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31"},{"text":"%pyspark\nimport numpy as np\n\ndef parse(m):\n        tmp = m.split(\",\")\n        w = tmp[0][1:]\n        v = tmp[1][:-1]\n        return {'w':w,'v':v}\n\nw2vMap = sc.textFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/w2v-map-engnouns-500f10w5mc100i\")\\\n        .map (lambda  m :  parse(m))\\\n        .filter(lambda m: len(m['w']) > 3)\\\n        .map (lambda m: (m['w'], np.array([float(x) for x in m['v'].split(' ')])))\n     \nprint(w2vMap.count())\n","dateUpdated":"Feb 24, 2016 6:56:07 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455312086904_-1064361193","id":"20160213-002126_562571930","result":{"code":"SUCCESS","type":"TEXT","msg":"16631\n"},"dateCreated":"Feb 13, 2016 12:21:26 AM","dateStarted":"Feb 24, 2016 6:56:07 PM","dateFinished":"Feb 24, 2016 6:56:27 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:32"},{"text":"%pyspark\nfrom sklearn.manifold import TSNE\nfrom sklearn.preprocessing import MinMaxScaler\n\nsample = w2vMap.collect()\nX_list = []\nword_list = []\n\nfor word, vector in sample:\n    #print(word, \" -> \", vector)\n    word_list.append(word)\n    X_list.append(vector)\n\n\nX_raw = np.array(X_list)\nprint(\"transforming data to two dimensions...\")\n\nmodelTSNE = TSNE(perplexity=50, early_exaggeration = 15, n_components=2, init='pca', n_iter=5000)\nnp.set_printoptions(suppress=True)\nX_2d = modelTSNE.fit_transform(X_raw) \n\n\nX_scaled = MinMaxScaler().fit_transform(X_2d)\nwordmap = {}\n\nprint(\"formatting data...\")\nfor i in range(0, len(X_scaled)):\n    x = X_scaled[i][0]\n    y = X_scaled[i][1]\n    key = word_list[i]\n    wordmap[key] = {\"x\": x, \"y\": y}\n    \nprint(\"formatting complete...\")\n","dateUpdated":"Feb 24, 2016 6:57:16 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455373406757_-1364913615","id":"20160213-172326_171450093","result":{"code":"SUCCESS","type":"TEXT","msg":"transforming data to two dimensions...\nformatting data...\nformatting complete...\n"},"dateCreated":"Feb 13, 2016 5:23:26 PM","dateStarted":"Feb 24, 2016 6:57:16 PM","dateFinished":"Feb 24, 2016 7:06:47 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33"},{"text":"%pyspark\n\np=[]\nfor i in range(0, len(X_scaled)):\n    x = X_scaled[i][0]\n    y = X_scaled[i][1]\n    key = word_list[i]\n    p.append([key,x,y])\n    \n\nwordmapP = sc.parallelize(p)\nprint(wordmapP.take(5))\n\nwordmapP.saveAsTextFile(\"file:///home/ipertushin/Documents/data/analytics/spacy/w2v-map-engnouns-500f10w5mc100i-tsne2f15ee\")\n","dateUpdated":"Feb 24, 2016 7:09:27 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455876057517_65036729","id":"20160219-130057_994877422","result":{"code":"SUCCESS","type":"TEXT","msg":"[[u'preces', 0.91399332395881272, 0.58544212697641806], [u'coli', 0.10383216883678814, 0.56861171924251064], [u'molly', 0.25607002688943392, 0.26597102879825907], [u'chanel', 0.50925413049009738, 0.5327146263905348], [u'double', 0.35862151678730092, 0.47630991229211084]]\n"},"dateCreated":"Feb 19, 2016 1:00:57 PM","dateStarted":"Feb 24, 2016 7:09:27 PM","dateFinished":"Feb 24, 2016 7:09:28 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34"},{"text":"%pyspark\nfrom pyspark.mllib.clustering import KMeans, KMeansModel\n#from numpy import array\nfrom math import sqrt\n\n# Build the model (cluster the data)\nN = 1000\nprint(\"build model with \", N, \"clusters\")\n\ndataVectrors = sc.parallelize(X_scaled)\n\nkMeansModel = KMeans.train(dataVectrors, N, maxIterations=1000,\\\n                           initializationMode=\"random\")\n\nvectors = dataVectrors.collect()\nclusters = {}\nfor v in vectors:\n    cluster_id = kMeansModel.predict(v)\n    clusters.setdefault(cluster_id, []).append(v)\n    \n# Evaluate clustering by computing Within Set Sum of Squared Errors\ndef error(point):\n    center = kMeansModel.centers[kMeansModel.predict(point)]\n    return sqrt(sum([x**2 for x in (point - center)]))\n\nWSSSE = dataVectrors.map(lambda point: error(point)).reduce(lambda x, y: x + y)\nprint(\"Within Set Sum of Squared Error = \", str(WSSSE))\n\n# Save and load model\nkMeansModel.save(sc, \"file:///home/ipertushin/Documents/data/analytics/spacy/kmeans-model-engnouns-500f10w5mc100i-tsne2f15ee-1000k1000i\")\n#sameModel = KMeansModel.load(sc, \"myModelPath\")","dateUpdated":"Feb 24, 2016 7:15:42 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455455702346_914207841","id":"20160214-161502_870757931","result":{"code":"SUCCESS","type":"TEXT","msg":"('build model with ', 1000, 'clusters')\n('Within Set Sum of Squared Error = ', '133.39349614')\n"},"dateCreated":"Feb 14, 2016 4:15:02 PM","dateStarted":"Feb 24, 2016 7:15:42 PM","dateFinished":"Feb 24, 2016 7:17:30 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:35"},{"text":"%pyspark\nimport colorsys\nN=100\nHSV_tuples = [(x*1.0/N, 0.5, 0.5) for x in range(N)]\n#print(HSV_tuples)\n\nRGB_tuples = list(map(lambda x: colorsys.hsv_to_rgb(*x), HSV_tuples))\n\nprint(\"colors are ready for\", N, \"clusters\")","dateUpdated":"Feb 24, 2016 4:09:02 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455463520891_604103891","id":"20160214-182520_956812225","result":{"code":"SUCCESS","type":"TEXT","msg":"('colors are ready for', 100, 'clusters')\n"},"dateCreated":"Feb 14, 2016 6:25:20 PM","dateStarted":"Feb 24, 2016 4:09:02 PM","dateFinished":"Feb 24, 2016 4:09:02 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:36"},{"text":"%pyspark\n\nimport matplotlib\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.spatial import ConvexHull\n\nimport StringIO\ndef show(p):\n  img = StringIO.StringIO()\n  p.savefig(img, format='svg')\n  img.seek(0)\n  print '%html ' + img.buf\n  \nplt.clf()\n\n\nlabels = []\nx = []\ny = []\n\nfor word, vector in wordmap.items():\n    labels.append(word)\n    x.append(vector.get('x'))\n    y.append(vector.get('y'))\n\n#print(labels)\nplt.figure(figsize=(100, 100))  #in inches\n\n\nfor clusterId, clusterVectors in clusters.items():\n    clusterColor =  RGB_tuples[clusterId]\n    points = []\n    for vec in clusterVectors:\n        points.append([vec[0],vec[1]])\n     \n   # points = np.array(points)\n    #hull = ConvexHull(points)\n\n\nfor i, label in enumerate(labels):\n    plt.plot(x[i], y[i], 'ro')\n    plt.annotate(label,\n                 xy=(x[i], y[i]),\n                 xytext=(3, 5),\n                 textcoords='offset points',\n                 ha='left',\n                 va='bottom')\n\nplt.savefig(\"/home/ipertushin/Documents/data/analytics/spacy/w2v-kmeans_1500k.png\")\n#show(plt)    ","dateUpdated":"Feb 24, 2016 4:51:06 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455463639242_1467247271","id":"20160214-182719_1421848609","result":{"code":"ERROR","type":"TEXT","msg":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark.py\", line 225, in <module>\n    eval(compiledCode)\n  File \"<string>\", line 20, in <module>\nNameError: name 'clusters' is not defined\n"},"dateCreated":"Feb 14, 2016 6:27:19 PM","dateStarted":"Feb 24, 2016 4:10:18 PM","dateFinished":"Feb 24, 2016 4:10:19 PM","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:37"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455464056841_575814718","id":"20160214-183416_859685177","dateCreated":"Feb 14, 2016 6:34:16 PM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:38"}],"name":"w2v kmeans visualize","id":"2BCSR65XA","angularObjects":{"2BD8AR35S":[],"2BC4QNSFT":[],"2BE6837H8":[],"2BCNDNYF5":[],"2BDGJM2CH":[],"2BAKHY72Q":[],"2BAUMHT49":[],"2BDZBDFU2":[],"2BCN1SHMW":[],"2BB1583ZZ":[],"2BB38YD3E":[],"2BD2D1RNN":[],"2BC87APGE":[],"2BDKTMTNW":[]},"config":{"looknfeel":"default"},"info":{}}